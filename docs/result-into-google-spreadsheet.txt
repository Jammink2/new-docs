# Writing Job Results into Google SpreadSheet

This article explains how to write job results directly to your Google SpreadSheet.

## Prerequisites

  * Basic knowledge of Treasure Data, including the [toolbelt](http://toolbelt.treasuredata.com).
  * A Google account (for Google Drive).

## Basic Usage

<center><img src="/images/result_xyz.png" width="100%" /></center><br /><br />

### For On-demand Jobs

For on-demand jobs, just add the `--result` option to the `td query` command. After the job is finished, the results are written into the worksheet `sample_worksheet` within the spreadsheet `sample_spreadsheet`.

    :::sql
    $ td query
      --result 'gspreadsheet://user:password@domain.com/sample_spreadsheet/sample_worksheet' \
      -w -d testdb \
      "SELECT v['code'] AS code, COUNT(1) AS cnt FROM www_access GROUP BY v['code']"

Here are some example URLs:

    :::text
    Gmail
    gspreadsheet://kazuki.ohta:password@gmail.com/TDTest/Sheet1
    
    Google Apps
    gspreadsheet://kazuki.ohta:password@treasure-data.com/TDTest/Sheet1

NOTE: If your password includes special characters such as ':', '@', etc., please convert them using URL encoding. Please see Wikipedia's [URL Encoding](https://en.wikipedia.org/wiki/Urlencode) article for details.

Shown below is a screenshot of the result.

<center><img src="/images/google-spreadsheet.png" width="60%" /></center><br /><br />

### For Scheduled Jobs

For scheduled jobs, just add the `--result` option when scheduling a job. After every job run, the results are written into `sample_worksheet`.

    :::term
    $ td sched:create hourly_count_example "0 * * * *" \
      -d testdb \
      --result "gspreadsheet://user:password@domain.com/sample_spreadsheet/sample_worksheet" \
      "SELECT v['code'] AS code, COUNT(1) AS cnt FROM www_access GROUP BY v['code']"

## Two Ways to Modify Data (Append/Replace)

You can add or delete data in two ways.

    :::term
    gspreadsheet://user:password@domain.com/sample_spreadsheet/sample_worksheet              # replace
    gspreadsheet://user:password@domain.com/sample_spreadsheet/sample_worksheet?mode=replace # replace
    gspreadsheet://user:password@domain.com/sample_spreadsheet/sample_worksheet?mode=append  # append

### REPLACE

This is the default mode. If the table already exists, the rows of the existing table are replaced with the query results. If the table does not exist yet, a new table will be created.

### APPEND

The query results are appended to the table. If the table does not exist yet, a new table will be created.

### Note

If you enabled 2-step verification in your Google Docs account, you may need to disable it for our service. Please see [Google's support document](http://support.google.com/accounts/bin/answer.py?hl=us&answer=1064203) for more information.
