# Sending Query Results to a Web Server

This article explains how to send job results directly to your web server.

## Prerequisites

  * Basic knowledge of Treasure Data, including [the toolbelt](http://toolbelt.treasure-data.com).
  * A web server configured to accept query results as PUT requests.

## Basic Usage

### For On-demand Jobs

For on-demand jobs, just add the `-r` option to the `td query` command. After the job is finished, the results are sent to the specified URL via a PUT request.

    :::term
    $ td query \
      -r 'web://domain.com/path' \
      -w -d testdb \
      "SELECT v['code'] AS code, COUNT(1) AS cnt FROM www_access GROUP BY v['code']"

Here is another example URL. [Basic HTTP authentication](http://en.wikipedia.org/wiki/Basic_access_authentication) and port specification are supported.

    :::text
    web://user:pass@domain.com:8080/path1/path2

NOTE: If a port number is not specified, the default value is 80.  If username and password are not given, then authentication is not used.

The request body is a JSON with the following fields: column_names, column_types, and data (the result of the query).  An example of what the query above may output is shown below.

    :::json
    { column_names: [ '_c0', '_c1' ],
      column_types: [ 'string', 'long' ],
      data: [ [ '200', 4981 ], [ '500', 2 ], [ '404', 17 ] ] }

NOTE: Maximum number of rows is limited to 100,000. If the result exceeds 100,000 rows, the remaining rows are thrown away.

### For Scheduled Jobs

For scheduled jobs, just add the `-r` option when scheduling a job. After every job run, the results are sent via PUT requests in the same manner as on-demand jobs.

    :::term
    $ td result:create myweb web://domain.com/
    $ td sched:create hourly_count_example "0 * * * *" \
      -d testdb \
      -r myweb:path \
      "SELECT v['code'] AS code, COUNT(1) AS cnt FROM www_access GROUP BY v['code']"
