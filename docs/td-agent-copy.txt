# Storing Logs Locally and Remotely

While [td-agent](td-agent) is uploading the data into the cloud, you also may want to store your logs in local nodes. In this case, please use td-agent's 'copy' function.

## Local Disk and Treasure Data

The configuration below will store logs in your local disk (*/mnt/archive/logs*) and in Treasure Data. The local files are created on an hourly basis.

    :::text
    <match td.*.*>
      type copy
      <store>
        type file
        path /mnt/archive/logs
        time_slice_format %Y%m%d%h
      </store>
      <store>
        type tdlog
        apikey YOUR_API_KEY_HERE
        auto_create_table
        buffer_type file
        buffer_path /var/log/td-agent/buffer/td
        use_ssl true
      </store>
    </match>

For more information regarding file output options, please refer to [this page](http://fluentd.org/doc/plugin.html#file).

## Local MongoDB and Treasure Data

The configuration below will store logs in your local MongoDB ReplicaSet and in Treasure Data. The logs are flushed into MongoDB every 60 seconds.

    :::text
    <match td.*.*>
      type copy
      <store>
        type mongo_replset
        database td
        collection logs
        nodes localhost:27017,localhost:27018,localhost:27019
      </store>
      <store>
        type tdlog
        apikey YOUR_API_KEY_HERE
        auto_create_table
        buffer_type file
        buffer_path /var/log/td-agent/buffer/td
        use_ssl true
      </store>
    </match>

For more information regarding MongoDB output options, please refer to [this page](https://github.com/fluent/fluent-plugin-mongo). There are plugins for various features such as authentication, capped collection, etc.

